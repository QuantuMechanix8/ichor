from pathlib import Path
from typing import Dict, List

import numpy as np
from ichor.core.calculators import calculate_alf_atom_sequence
from ichor.core.files import GJF, INTs
from ichor.core.files.aimall.int import CriticalPoint, CriticalPointType

from tests.path import get_cwd
from tests.test_files import _assert_val_optional
from tests.test_files.test_read_int import _assert_critical_point_instances

example_dir = get_cwd(__file__) / "example_ints_dir"


def _assert_dict_of_critical_points(
    critical_points_dict, reference_critical_points_dict
):
    """Asserts that a dictionary of critical points is equal to another reference dict of critical points."""

    for atom_name, critical_point_list in critical_points_dict.items():

        reference_cp_list = reference_critical_points_dict[atom_name]

        _assert_critical_point_instances(critical_point_list, reference_cp_list)


def _test_ints(
    int_dir_path: Path,
    atom_name: Dict[str, str] = None,
    atom_num: Dict[str, int] = None,
    title: Dict[str, str] = None,
    dft_model: Dict[str, str] = None,
    basin_integration_results: Dict[str, Dict[str, float]] = None,
    integration_error: Dict[str, float] = None,
    critical_points: Dict[str, List[CriticalPoint]] = None,
    bond_critical_points: Dict[str, List[CriticalPoint]] = None,
    ring_critical_points: Dict[str, List[CriticalPoint]] = None,
    cage_critical_points: Dict[str, List[CriticalPoint]] = None,
    properties: Dict[str, Dict[str, float]] = None,
    net_charge: Dict[str, float] = None,
    global_spherical_multipoles: Dict[str, Dict[str, float]] = None,
    local_spherical_multipoles: Dict[str, Dict[str, float]] = None,
    C_matrix_dict: Dict[str, np.ndarray] = None,
    iqa_energy_components: Dict[str, Dict[str, float]] = None,
    iqa: Dict[str, float] = None,
    e_intra: Dict[str, float] = None,
    q: Dict[str, float] = None,
    q00: Dict[str, float] = None,
    dipole_mag: Dict[str, float] = None,
    total_time: Dict[str, int] = None,
):

    """Test function for INTs directory"""

    int_dir_instance = INTs(int_dir_path)

    _assert_val_optional(int_dir_instance.atom_name, atom_name)
    _assert_val_optional(int_dir_instance.atom_num, atom_num)
    _assert_val_optional(int_dir_instance.title, title)

    _assert_val_optional(int_dir_instance.dft_model, dft_model)

    _assert_val_optional(
        int_dir_instance.basin_integration_results, basin_integration_results
    )
    _assert_val_optional(int_dir_instance.integration_error, integration_error)

    _assert_dict_of_critical_points(int_dir_instance.critical_points, critical_points)
    _assert_dict_of_critical_points(
        int_dir_instance.bond_critical_points, bond_critical_points
    )
    _assert_dict_of_critical_points(
        int_dir_instance.ring_critical_points, ring_critical_points
    )
    _assert_dict_of_critical_points(
        int_dir_instance.cage_critical_points, cage_critical_points
    )

    _assert_val_optional(int_dir_instance.net_charge, net_charge)
    _assert_val_optional(
        int_dir_instance.global_spherical_multipoles,
        global_spherical_multipoles,
    )

    _assert_val_optional(int_dir_instance.iqa_energy_components, iqa_energy_components)
    _assert_val_optional(int_dir_instance.iqa, iqa)
    _assert_val_optional(int_dir_instance.e_intra, e_intra)
    _assert_val_optional(int_dir_instance.q, q)
    _assert_val_optional(int_dir_instance.q00, q00)

    # these require having a C matrix to rotate multipoles
    # TODO: If dipole magnitude stays the same since we are rotating only, technically can use original multipoles.
    if C_matrix_dict is not None and local_spherical_multipoles is not None:
        _assert_val_optional(
            int_dir_instance.local_spherical_multipoles(C_matrix_dict),
            local_spherical_multipoles,
        )
        _assert_val_optional(int_dir_instance.dipole_mag, dipole_mag)
        _assert_val_optional(int_dir_instance.properties(C_matrix_dict), properties)

    _assert_val_optional(int_dir_instance.total_time, total_time)


def test_methanol_ints_dir():

    ints_dir_path = example_dir / "methanol_aimall_ints"

    gjf_inst = GJF(example_dir / "methanol_ints_reference_geometry.gjf")
    alfs = gjf_inst.alf(calculate_alf_atom_sequence)
    C_matrices_dict = gjf_inst.C_matrix_dict(alfs)

    reference_critical_points = {
        "C1": [
            CriticalPoint(
                1,
                CriticalPointType.Bond,
                0.17161777305,
                0.29532486222,
                -0.078719448795,
                ["O3"],
            ),
            CriticalPoint(
                2,
                CriticalPointType.Bond,
                -1.4656467152,
                1.3421771542,
                0.14289905288,
                ["H2"],
            ),
            CriticalPoint(
                3,
                CriticalPointType.Bond,
                -1.0276384918,
                -0.51439726513,
                1.2182276386,
                ["H4"],
            ),
            CriticalPoint(
                4,
                CriticalPointType.Bond,
                0.057953654735,
                1.2877842647,
                1.4658037325,
                ["H5"],
            ),
        ],
        "H2": [
            CriticalPoint(
                1,
                CriticalPointType.Bond,
                -1.4656467152,
                1.3421771542,
                0.14289905288,
                ["C1"],
            ),
        ],
        "O3": [
            CriticalPoint(
                1,
                CriticalPointType.Bond,
                0.17161777305,
                0.29532486222,
                -0.078719448795,
                ["C1"],
            ),
            CriticalPoint(
                2,
                CriticalPointType.Bond,
                1.2574661206,
                -0.48707600771,
                -2.5804638375,
                ["H6"],
            ),
        ],
        "H4": [
            CriticalPoint(
                1,
                CriticalPointType.Bond,
                -1.0276384918,
                -0.51439726513,
                1.2182276386,
                ["C1"],
            ),
        ],
        "H5": [
            CriticalPoint(
                1,
                CriticalPointType.Bond,
                0.057953654735,
                1.2877842647,
                1.4658037325,
                ["C1"],
            ),
        ],
        "H6": [
            CriticalPoint(
                1,
                CriticalPointType.Bond,
                1.2574661206,
                -0.48707600771,
                -2.5804638375,
                ["O3"],
            ),
        ],
    }

    reference_bond_critical_points = {
        "C1": [
            CriticalPoint(
                1,
                CriticalPointType.Bond,
                0.17161777305,
                0.29532486222,
                -0.078719448795,
                ["O3"],
            ),
            CriticalPoint(
                2,
                CriticalPointType.Bond,
                -1.4656467152,
                1.3421771542,
                0.14289905288,
                ["H2"],
            ),
            CriticalPoint(
                3,
                CriticalPointType.Bond,
                -1.0276384918,
                -0.51439726513,
                1.2182276386,
                ["H4"],
            ),
            CriticalPoint(
                4,
                CriticalPointType.Bond,
                0.057953654735,
                1.2877842647,
                1.4658037325,
                ["H5"],
            ),
        ],
        "H2": [
            CriticalPoint(
                1,
                CriticalPointType.Bond,
                -1.4656467152,
                1.3421771542,
                0.14289905288,
                ["C1"],
            ),
        ],
        "O3": [
            CriticalPoint(
                1,
                CriticalPointType.Bond,
                0.17161777305,
                0.29532486222,
                -0.078719448795,
                ["C1"],
            ),
            CriticalPoint(
                2,
                CriticalPointType.Bond,
                1.2574661206,
                -0.48707600771,
                -2.5804638375,
                ["H6"],
            ),
        ],
        "H4": [
            CriticalPoint(
                1,
                CriticalPointType.Bond,
                -1.0276384918,
                -0.51439726513,
                1.2182276386,
                ["C1"],
            ),
        ],
        "H5": [
            CriticalPoint(
                1,
                CriticalPointType.Bond,
                0.057953654735,
                1.2877842647,
                1.4658037325,
                ["C1"],
            ),
        ],
        "H6": [
            CriticalPoint(
                1,
                CriticalPointType.Bond,
                1.2574661206,
                -0.48707600771,
                -2.5804638375,
                ["O3"],
            ),
        ],
    }

    reference_properties = {
        "C1": {
            "iqa": -38.039986449,
            "q00": 0.54283906397,
            "q10": -0.05767335746841548,
            "q11c": -0.31595336347551817,
            "q11s": 0.5174410549922349,
            "q20": -0.4391729927935119,
            "q21c": -0.2431647932276424,
            "q21s": -0.05917193428970245,
            "q22c": -0.35155985411093815,
            "q22s": -0.6006618901439597,
            "q30": -1.2283884392848183,
            "q31c": -1.2933421695509766,
            "q31s": -1.4817895818223001,
            "q32c": -0.2997236489159159,
            "q32s": 0.48461525391261595,
            "q33c": 1.4524199328622134,
            "q33s": 0.31494230964485065,
            "q40": -0.11898980950701016,
            "q41c": -0.10459804178196738,
            "q41s": 1.5626112864579236,
            "q42c": -3.0338341215758877,
            "q42s": 0.5576852481306787,
            "q43c": 1.1164173126300687,
            "q43s": 0.12124806557785926,
            "q44c": 1.9562018741307414,
            "q44s": -1.13559096185478,
        },
        "H2": {
            "iqa": -0.58793326086,
            "q00": -0.0020682526006,
            "q10": 0.031056039393207696,
            "q11c": 0.1509407716400723,
            "q11s": -0.01993034602373966,
            "q20": -0.09996993713783385,
            "q21c": -0.018673478853786146,
            "q21s": -0.005539796179726547,
            "q22c": 0.16543872566384477,
            "q22s": 0.007971960960162576,
            "q30": 0.05914922734502527,
            "q31c": 0.2162454299288532,
            "q31s": -0.0749108128440233,
            "q32c": -0.021283747688120646,
            "q32s": 0.0027187871483907457,
            "q33c": -0.20084487310838317,
            "q33s": 0.008553671632409226,
            "q40": 0.011797474416172439,
            "q41c": -0.13248960851628025,
            "q41s": -0.016637261606446224,
            "q42c": -0.0018243220332483203,
            "q42s": 0.05776865347595029,
            "q43c": 0.07989422892589353,
            "q43s": -0.0077805669128617645,
            "q44c": -0.04738135365869915,
            "q44s": -0.004951734532283035,
        },
        "H4": {
            "iqa": -0.58903652354,
            "q00": 0.0051683891523,
            "q10": -0.04653433041862536,
            "q11c": 0.11424918095228898,
            "q11s": 0.07979293663347664,
            "q20": -0.06553247976634936,
            "q21c": -0.09696451485667806,
            "q21s": -0.06001238028763897,
            "q22c": 0.08992819669808498,
            "q22s": 0.11073512974558909,
            "q30": -0.17603634920801678,
            "q31c": 0.06277822597004049,
            "q31s": 0.02021910546370733,
            "q32c": 0.024784667466737412,
            "q32s": 0.1308930894780729,
            "q33c": -0.023020645288334682,
            "q33s": -0.18315028196914923,
            "q40": -0.015926143323910902,
            "q41c": 0.021160682156780648,
            "q41s": 0.011836900573288015,
            "q42c": -0.031463509391532925,
            "q42s": -0.04425981982972008,
            "q43c": 0.0463633035015395,
            "q43s": 0.05750043676819708,
            "q44c": -0.015937726707738895,
            "q44s": -0.0057095183848348535,
        },
        "H5": {
            "iqa": -0.58591868462,
            "q00": 0.0077237562113,
            "q10": -0.05433509765792753,
            "q11c": 0.10842268525527055,
            "q11s": 0.08403856897934282,
            "q20": -0.07750105560211235,
            "q21c": -0.06619065697513679,
            "q21s": -0.01914287215864204,
            "q22c": 0.045426256133692895,
            "q22s": 0.1313299777720261,
            "q30": -0.17660594769325214,
            "q31c": 0.043902079439366526,
            "q31s": 0.08167138328674864,
            "q32c": 0.05601812203800709,
            "q32s": 0.058363954675420354,
            "q33c": 0.08127570039491659,
            "q33s": -0.15891757224058892,
            "q40": -0.046872601307757916,
            "q41c": 0.06189215906127515,
            "q41s": 0.10017766089840972,
            "q42c": 0.03539745343851513,
            "q42s": 0.0036245633840584672,
            "q43c": 0.03784323193475522,
            "q43s": 0.02985338861147865,
            "q44c": -0.07315610987416672,
            "q44s": -0.037564065179201,
        },
        "H6": {
            "iqa": -0.48306665702,
            "q00": 0.58589900221,
            "q10": -0.059034718250399285,
            "q11c": 0.11295480162926753,
            "q11s": 0.10361919350091942,
            "q20": -0.001670822074677014,
            "q21c": 0.009971221431902088,
            "q21s": 0.014332203310046754,
            "q22c": 0.009928695348814808,
            "q22s": -0.00880337217557924,
            "q30": -0.048037338780126435,
            "q31c": 0.04025723476229891,
            "q31s": 0.02630850478449637,
            "q32c": 0.014687344154739029,
            "q32s": 0.06466347917382488,
            "q33c": 0.03492810457118391,
            "q33s": -0.08939126607052633,
            "q40": 0.00980399977393746,
            "q41c": 0.11028064747961917,
            "q41s": 0.08843746683871725,
            "q42c": -0.026234376644386326,
            "q42s": -0.03717406086379858,
            "q43c": 0.08784639518423865,
            "q43s": -0.12643202688906094,
            "q44c": -0.15242376155737736,
            "q44s": 0.06485722450549057,
        },
        "O3": {
            "iqa": -75.433613432,
            "q00": -1.1395979259,
            "q10": 0.1475868197648511,
            "q11c": 0.009449742686532231,
            "q11s": 0.04319889540033416,
            "q20": 0.10225312057802824,
            "q21c": 0.37775459816939655,
            "q21s": 0.3924226515797919,
            "q22c": 0.3025697013563165,
            "q22s": 0.46266353780997643,
            "q30": 0.06642808797287061,
            "q31c": -0.23169839750283377,
            "q31s": -0.4356310337979971,
            "q32c": 0.11683972370248422,
            "q32s": -0.35232406785935205,
            "q33c": -0.008006955652991895,
            "q33s": -0.36758684829803107,
            "q40": 0.501336667395503,
            "q41c": 1.6492178283302426,
            "q41s": 1.8152300290253898,
            "q42c": -0.20900604616663776,
            "q42s": 1.0916212621940744,
            "q43c": -0.306731404723354,
            "q43s": -0.22433236967098755,
            "q44c": 0.12609722200523013,
            "q44s": -1.017844992712948,
        },
    }

    reference_global_spherical_multipoles = {
        "C1": {
            "q00": 0.54283906397,
            "q10": -0.35756588345,
            "q11c": 0.48495495846,
            "q11s": -0.088675344388,
            "q20": 0.03424254444,
            "q21c": -0.79106576012,
            "q21s": 0.13231069042,
            "q22c": 0.1573373258,
            "q22s": -0.26584515755,
            "q30": -0.34415748841,
            "q31c": 0.67006736213,
            "q31s": 0.27770245123,
            "q32c": -0.89734958811,
            "q32s": 2.2717633012,
            "q33c": 0.70579456359,
            "q33s": 0.8955037554,
            "q40": -0.45030621554,
            "q41c": -0.21724674562,
            "q41s": 1.9154129342,
            "q42c": -1.5474303314,
            "q42s": 2.2605450221,
            "q43c": 0.37577458395,
            "q43s": -1.4760918821,
            "q44c": -1.6489399156,
            "q44s": -1.3773007607,
            "q50": -0.86393319918,
            "q51c": 1.134825092,
            "q51s": -1.8239970863,
            "q52c": 1.1491980093,
            "q52s": 0.13918108499,
            "q53c": -2.2857652332,
            "q53s": 4.5386509061,
            "q54c": -0.08196438995,
            "q54s": 0.25499954821,
            "q55c": -0.45851170642,
            "q55s": 1.6638756293,
        },
        "H2": {
            "q00": -0.0020682526006,
            "q10": 0.06892703758,
            "q11c": 0.1180918724,
            "q11s": -0.0738118282,
            "q20": -0.077509465813,
            "q21c": 0.052090378031,
            "q21s": -0.048274906806,
            "q22c": 0.010111587094,
            "q22s": -0.16325766445,
            "q30": 0.060363417692,
            "q31c": 0.099388408543,
            "q31s": 0.00068781338505,
            "q32c": -0.03362481349,
            "q32s": 0.19605196062,
            "q33c": 0.085648270673,
            "q33s": 0.19057719791,
            "q40": -0.041443351166,
            "q41c": 0.0002922200152,
            "q41s": -0.048867858731,
            "q42c": -0.055383744848,
            "q42s": -0.066216440585,
            "q43c": 0.01497434306,
            "q43s": -0.079495774614,
            "q44c": 0.06274313103,
            "q44s": -0.089358647693,
            "q50": 0.30546071647,
            "q51c": 0.17513392267,
            "q51s": -0.073999548379,
            "q52c": -0.21512220725,
            "q52s": 0.45577849244,
            "q53c": -0.23659832768,
            "q53s": 0.18960325253,
            "q54c": -0.92365695013,
            "q54s": -0.22937477944,
            "q55c": -0.72699504018,
            "q55s": 0.39119662727,
        },
        "H4": {
            "q00": 0.0051683891523,
            "q10": -0.061850406127,
            "q11c": 0.062536322511,
            "q11s": 0.11768163672,
            "q20": -0.012484484807,
            "q21c": -0.086620216756,
            "q21s": -0.1298879012,
            "q22c": -0.063925365413,
            "q22s": 0.095032703958,
            "q30": -0.1077687474,
            "q31c": -0.019580387991,
            "q31s": 0.002835117537,
            "q32c": -0.096134657122,
            "q32s": 0.22966290296,
            "q33c": 0.10536429461,
            "q33s": 0.045451978587,
            "q40": 0.075609765137,
            "q41c": 0.02694593534,
            "q41s": 0.017269023656,
            "q42c": 0.043223542237,
            "q42s": 0.0032771435364,
            "q43c": 0.010387641349,
            "q43s": -0.024774144449,
            "q44c": 0.012128327763,
            "q44s": 0.0066308028298,
            "q50": -0.21841679108,
            "q51c": -0.34286587044,
            "q51s": -0.49913803206,
            "q52c": -0.21286349536,
            "q52s": 0.21687545546,
            "q53c": -0.71683534996,
            "q53s": 0.24377301311,
            "q54c": 0.28990114841,
            "q54s": 0.71046976901,
            "q55c": 0.29330556912,
            "q55s": 0.056658682819,
        },
        "H5": {
            "q00": 0.0077237562113,
            "q10": -0.10977823489,
            "q11c": -0.065301786036,
            "q11s": -0.073855795145,
            "q20": 0.028603562019,
            "q21c": 0.064476841376,
            "q21s": 0.13973436661,
            "q22c": -0.023349348247,
            "q22s": 0.07084392665,
            "q30": -0.010900470918,
            "q31c": 0.063327105527,
            "q31s": 0.13847514146,
            "q32c": -0.10966071956,
            "q32s": 0.19323089202,
            "q33c": 0.0029369768585,
            "q33s": 0.074265734965,
            "q40": 0.062539023715,
            "q41c": 0.054479503306,
            "q41s": 0.053964203197,
            "q42c": -0.050465995669,
            "q42s": 0.099550760326,
            "q43c": -0.00090741603833,
            "q43s": 0.014282217837,
            "q44c": -0.00095073940483,
            "q44s": 0.062939739343,
            "q50": 0.13492506562,
            "q51c": 0.20527277218,
            "q51s": 0.23308723226,
            "q52c": 0.36520150464,
            "q52s": -0.22228347765,
            "q53c": 0.63668002052,
            "q53s": 0.11682869289,
            "q54c": 0.40674404834,
            "q54s": -0.02588586243,
            "q55c": 0.19894812215,
            "q55s": -0.089496852624,
        },
        "H6": {
            "q00": 0.58589900221,
            "q10": 0.15360804702,
            "q11c": 0.032679729575,
            "q11s": 0.048139646835,
            "q20": -0.0068874597882,
            "q21c": -0.018682694654,
            "q21s": -0.0067540271446,
            "q22c": -0.0020267433649,
            "q22s": -0.0061239329483,
            "q30": -0.099631758944,
            "q31c": -0.022370368691,
            "q31s": -0.086312833315,
            "q32c": 0.015232810639,
            "q32s": -0.010864133914,
            "q33c": -0.00041035183045,
            "q33s": 0.0010772895575,
            "q40": 0.13692961866,
            "q41c": 0.082963078415,
            "q41s": 0.20513814221,
            "q42c": -0.037958409504,
            "q42s": 0.063654844543,
            "q43c": -0.0069431336486,
            "q43s": 0.0052303480301,
            "q44c": 0.0028049245927,
            "q44s": 0.00057108572959,
            "q50": -0.020940794836,
            "q51c": -0.10268842113,
            "q51s": -0.16636656189,
            "q52c": 0.022750071933,
            "q52s": -0.11959651453,
            "q53c": 0.029607123207,
            "q53s": -0.03590511853,
            "q54c": -0.0073772897848,
            "q54s": 0.00484876026,
            "q55c": -0.008505543431,
            "q55s": -0.0034327856408,
        },
        "O3": {
            "q00": -1.1395979259,
            "q10": 0.13401606796,
            "q11c": 0.057997397409,
            "q11s": 0.049125421029,
            "q20": 0.50829750083,
            "q21c": -0.34541806498,
            "q21s": 0.4056277463,
            "q22c": 0.23654123731,
            "q22s": -0.12078962495,
            "q30": -0.50397426087,
            "q31c": 0.058370147108,
            "q31s": -0.39915459727,
            "q32c": -0.1659782592,
            "q32s": 0.21619900331,
            "q33c": 0.17222298998,
            "q33s": 0.01288937709,
            "q40": 1.1765769995,
            "q41c": 1.0892285281,
            "q41s": 1.6298742897,
            "q42c": -0.98631291173,
            "q42s": 1.3738013752,
            "q43c": 0.22509376634,
            "q43s": -0.68321809213,
            "q44c": -0.3049865817,
            "q44s": -0.0099894708787,
            "q50": -0.058843311791,
            "q51c": -2.4836153714,
            "q51s": -1.6669818364,
            "q52c": 0.39129285403,
            "q52s": -1.7752954277,
            "q53c": 1.2126275842,
            "q53s": -0.60627961975,
            "q54c": -0.040523925716,
            "q54s": 0.55692357684,
            "q55c": 0.025273139715,
            "q55s": -0.27324825206,
        },
    }

    referece_local_spherical_multipoles = {
        "C1": {
            "q00": 0.54283906397,
            "q10": -0.05767335746841548,
            "q11c": -0.31595336347551817,
            "q11s": 0.5174410549922349,
            "q20": -0.4391729927935119,
            "q21c": -0.2431647932276424,
            "q21s": -0.05917193428970245,
            "q22c": -0.35155985411093815,
            "q22s": -0.6006618901439597,
            "q30": -1.2283884392848183,
            "q31c": -1.2933421695509766,
            "q31s": -1.4817895818223001,
            "q32c": -0.2997236489159159,
            "q32s": 0.48461525391261595,
            "q33c": 1.4524199328622134,
            "q33s": 0.31494230964485065,
            "q40": -0.11898980950701016,
            "q41c": -0.10459804178196738,
            "q41s": 1.5626112864579236,
            "q42c": -3.0338341215758877,
            "q42s": 0.5576852481306787,
            "q43c": 1.1164173126300687,
            "q43s": 0.12124806557785926,
            "q44c": 1.9562018741307414,
            "q44s": -1.13559096185478,
        },
        "H2": {
            "q00": -0.0020682526006,
            "q10": 0.031056039393207696,
            "q11c": 0.1509407716400723,
            "q11s": -0.01993034602373966,
            "q20": -0.09996993713783385,
            "q21c": -0.018673478853786146,
            "q21s": -0.005539796179726547,
            "q22c": 0.16543872566384477,
            "q22s": 0.007971960960162576,
            "q30": 0.05914922734502527,
            "q31c": 0.2162454299288532,
            "q31s": -0.0749108128440233,
            "q32c": -0.021283747688120646,
            "q32s": 0.0027187871483907457,
            "q33c": -0.20084487310838317,
            "q33s": 0.008553671632409226,
            "q40": 0.011797474416172439,
            "q41c": -0.13248960851628025,
            "q41s": -0.016637261606446224,
            "q42c": -0.0018243220332483203,
            "q42s": 0.05776865347595029,
            "q43c": 0.07989422892589353,
            "q43s": -0.0077805669128617645,
            "q44c": -0.04738135365869915,
            "q44s": -0.004951734532283035,
        },
        "H4": {
            "q00": 0.0051683891523,
            "q10": -0.04653433041862536,
            "q11c": 0.11424918095228898,
            "q11s": 0.07979293663347664,
            "q20": -0.06553247976634936,
            "q21c": -0.09696451485667806,
            "q21s": -0.06001238028763897,
            "q22c": 0.08992819669808498,
            "q22s": 0.11073512974558909,
            "q30": -0.17603634920801678,
            "q31c": 0.06277822597004049,
            "q31s": 0.02021910546370733,
            "q32c": 0.024784667466737412,
            "q32s": 0.1308930894780729,
            "q33c": -0.023020645288334682,
            "q33s": -0.18315028196914923,
            "q40": -0.015926143323910902,
            "q41c": 0.021160682156780648,
            "q41s": 0.011836900573288015,
            "q42c": -0.031463509391532925,
            "q42s": -0.04425981982972008,
            "q43c": 0.0463633035015395,
            "q43s": 0.05750043676819708,
            "q44c": -0.015937726707738895,
            "q44s": -0.0057095183848348535,
        },
        "H5": {
            "q00": 0.0077237562113,
            "q10": -0.05433509765792753,
            "q11c": 0.10842268525527055,
            "q11s": 0.08403856897934282,
            "q20": -0.07750105560211235,
            "q21c": -0.06619065697513679,
            "q21s": -0.01914287215864204,
            "q22c": 0.045426256133692895,
            "q22s": 0.1313299777720261,
            "q30": -0.17660594769325214,
            "q31c": 0.043902079439366526,
            "q31s": 0.08167138328674864,
            "q32c": 0.05601812203800709,
            "q32s": 0.058363954675420354,
            "q33c": 0.08127570039491659,
            "q33s": -0.15891757224058892,
            "q40": -0.046872601307757916,
            "q41c": 0.06189215906127515,
            "q41s": 0.10017766089840972,
            "q42c": 0.03539745343851513,
            "q42s": 0.0036245633840584672,
            "q43c": 0.03784323193475522,
            "q43s": 0.02985338861147865,
            "q44c": -0.07315610987416672,
            "q44s": -0.037564065179201,
        },
        "H6": {
            "q00": 0.58589900221,
            "q10": -0.059034718250399285,
            "q11c": 0.11295480162926753,
            "q11s": 0.10361919350091942,
            "q20": -0.001670822074677014,
            "q21c": 0.009971221431902088,
            "q21s": 0.014332203310046754,
            "q22c": 0.009928695348814808,
            "q22s": -0.00880337217557924,
            "q30": -0.048037338780126435,
            "q31c": 0.04025723476229891,
            "q31s": 0.02630850478449637,
            "q32c": 0.014687344154739029,
            "q32s": 0.06466347917382488,
            "q33c": 0.03492810457118391,
            "q33s": -0.08939126607052633,
            "q40": 0.00980399977393746,
            "q41c": 0.11028064747961917,
            "q41s": 0.08843746683871725,
            "q42c": -0.026234376644386326,
            "q42s": -0.03717406086379858,
            "q43c": 0.08784639518423865,
            "q43s": -0.12643202688906094,
            "q44c": -0.15242376155737736,
            "q44s": 0.06485722450549057,
        },
        "O3": {
            "q00": -1.1395979259,
            "q10": 0.1475868197648511,
            "q11c": 0.009449742686532231,
            "q11s": 0.04319889540033416,
            "q20": 0.10225312057802824,
            "q21c": 0.37775459816939655,
            "q21s": 0.3924226515797919,
            "q22c": 0.3025697013563165,
            "q22s": 0.46266353780997643,
            "q30": 0.06642808797287061,
            "q31c": -0.23169839750283377,
            "q31s": -0.4356310337979971,
            "q32c": 0.11683972370248422,
            "q32s": -0.35232406785935205,
            "q33c": -0.008006955652991895,
            "q33s": -0.36758684829803107,
            "q40": 0.501336667395503,
            "q41c": 1.6492178283302426,
            "q41s": 1.8152300290253898,
            "q42c": -0.20900604616663776,
            "q42s": 1.0916212621940744,
            "q43c": -0.306731404723354,
            "q43s": -0.22433236967098755,
            "q44c": 0.12609722200523013,
            "q44s": -1.017844992712948,
        },
    }

    reference_iqa_energy_components = {
        "C1": {
            "E_IQA(A)": -38.039986449,
            "E_IQA0(A)": -37.825471473,
            "E_IQA_Inter(A)": -0.60283942747,
            "E_IQA_Inter0(A)": -0.60283942747,
            "E_IQA_Intra(A)": -37.437147022,
            "E_IQA_Intra0(A)": -37.222632046,
            "T(A)": 37.243325182,
            "VC_IQA(A)": -70.106822659,
            "VC_IQA(A,A')/2": -0.0646291394,
            "VC_IQA(A,A)": -70.042193519,
            "VX_IQA(A)": -5.1764889722,
            "VX_IQA(A,A')/2": -0.53821028807,
            "VX_IQA(A,A)": -4.6382786842,
            "V_IQA(A)": -75.283311631,
            "V_IQA(A,A')/2": -0.60283942747,
            "V_IQA(A,A)": -74.680472204,
            "Vee(A,A')/2": 11.869257288,
            "Vee(A,A)": 12.649426468,
            "Vee(A,A) + Vee(A,A')/2": 24.518683756,
            "Vee0(A,A')/2": 11.869257288,
            "Vee0(A,A)": 12.863941444,
            "Vee0(A,A) + Vee0(A,A')/2": 24.733198732,
            "VeeC(A,A')/2": 12.407467576,
            "VeeC(A,A)": 17.287705152,
            "VeeC(A,A) + VeeC(A,A')/2": 29.695172728,
            "VeeX(A,A')/2": -0.53821028807,
            "VeeX(A,A)": -4.6382786842,
            "VeeX(A,A) + VeeX(A,A')/2": -5.1764889722,
            "VeeX0(A,A')/2": -0.53821028807,
            "VeeX0(A,A)": -4.4237637083,
            "VeeX0(A,A) + VeeX0(A,A')/2": -4.9619739964,
            "Ven(A,A')/2": -12.113219014,
            "Ven(A,Mol)/2": -55.77816835,
            "Vne(A,A')/2": -14.343140457,
            "Vne(A,Mol)/2": -58.008089793,
            "Vneen(A,A')/2": -26.456359471,
            "Vneen(A,A)/2 = Vne(A,A)": -87.329898672,
            "Vneen(A,Mol)/2": -113.78625814,
            "Vnn(A,Mol)/2": 13.984262756,
        },
        "H2": {
            "E_IQA(A)": -0.58793326086,
            "E_IQA0(A)": -0.56155496261,
            "E_IQA_Inter(A)": -0.12695464331,
            "E_IQA_Inter0(A)": -0.12695464331,
            "E_IQA_Intra(A)": -0.46097861755,
            "E_IQA_Intra0(A)": -0.4346003193,
            "T(A)": 0.59707321472,
            "VC_IQA(A)": -0.82087251948,
            "VC_IQA(A,A')/2": 0.015846407718,
            "VC_IQA(A,A)": -0.83671892719,
            "VX_IQA(A)": -0.36413395611,
            "VX_IQA(A,A')/2": -0.14280105103,
            "VX_IQA(A,A)": -0.22133290507,
            "V_IQA(A)": -1.1850064756,
            "V_IQA(A,A')/2": -0.12695464331,
            "V_IQA(A,A)": -1.0580518323,
            "Vee(A,A')/2": 2.3760997145,
            "Vee(A,A)": 0.19360073368,
            "Vee(A,A) + Vee(A,A')/2": 2.5697004482,
            "Vee0(A,A')/2": 2.3760997145,
            "Vee0(A,A)": 0.21997903193,
            "Vee0(A,A) + Vee0(A,A')/2": 2.5960787465,
            "VeeC(A,A')/2": 2.5189007656,
            "VeeC(A,A)": 0.41493363875,
            "VeeC(A,A) + VeeC(A,A')/2": 2.9338344043,
            "VeeX(A,A')/2": -0.14280105103,
            "VeeX(A,A)": -0.22133290507,
            "VeeX(A,A) + VeeX(A,A')/2": -0.36413395611,
            "VeeX0(A,A')/2": -0.14280105103,
            "VeeX0(A,A)": -0.19495460682,
            "VeeX0(A,A) + VeeX0(A,A')/2": -0.33775565786,
            "Ven(A,A')/2": -2.5738995639,
            "Ven(A,Mol)/2": -3.1997258468,
            "Vne(A,A')/2": -2.6671243714,
            "Vne(A,Mol)/2": -3.2929506544,
            "Vneen(A,A')/2": -5.2410239353,
            "Vneen(A,A)/2 = Vne(A,A)": -1.2516525659,
            "Vneen(A,Mol)/2": -6.4926765012,
            "Vnn(A,Mol)/2": 2.7379695774,
        },
        "H4": {
            "E_IQA(A)": -0.58903652354,
            "E_IQA0(A)": -0.56358257348,
            "E_IQA_Inter(A)": -0.12788447962,
            "E_IQA_Inter0(A)": -0.12788447962,
            "E_IQA_Intra(A)": -0.46115204392,
            "E_IQA_Intra0(A)": -0.43569809386,
            "T(A)": 0.6063389124,
            "VC_IQA(A)": -0.82811508706,
            "VC_IQA(A,A')/2": 0.018076115474,
            "VC_IQA(A,A)": -0.84619120253,
            "VX_IQA(A)": -0.36726034888,
            "VX_IQA(A,A')/2": -0.1459605951,
            "VX_IQA(A,A)": -0.22129975379,
            "V_IQA(A)": -1.1953754359,
            "V_IQA(A,A')/2": -0.12788447962,
            "V_IQA(A,A)": -1.0674909563,
            "Vee(A,A')/2": 2.3797608955,
            "Vee(A,A)": 0.1947967259,
            "Vee(A,A) + Vee(A,A')/2": 2.5745576214,
            "Vee0(A,A')/2": 2.3797608955,
            "Vee0(A,A)": 0.22025067597,
            "Vee0(A,A) + Vee0(A,A')/2": 2.6000115714,
            "VeeC(A,A')/2": 2.5257214906,
            "VeeC(A,A)": 0.41609647969,
            "VeeC(A,A) + VeeC(A,A')/2": 2.9418179703,
            "VeeX(A,A')/2": -0.1459605951,
            "VeeX(A,A)": -0.22129975379,
            "VeeX(A,A) + VeeX(A,A')/2": -0.36726034888,
            "VeeX0(A,A')/2": -0.1459605951,
            "VeeX0(A,A)": -0.19584580372,
            "VeeX0(A,A) + VeeX0(A,A')/2": -0.34180639882,
            "Ven(A,A')/2": -2.5818544188,
            "Ven(A,Mol)/2": -3.2129982599,
            "Vne(A,A')/2": -2.6950799644,
            "Vne(A,Mol)/2": -3.3262238056,
            "Vneen(A,A')/2": -5.2769343832,
            "Vneen(A,A)/2 = Vne(A,A)": -1.2622876822,
            "Vneen(A,Mol)/2": -6.5392220654,
            "Vnn(A,Mol)/2": 2.7692890081,
        },
        "H5": {
            "E_IQA(A)": -0.58591868462,
            "E_IQA0(A)": -0.5599485412,
            "E_IQA_Inter(A)": -0.12858803315,
            "E_IQA_Inter0(A)": -0.12858803315,
            "E_IQA_Intra(A)": -0.45733065147,
            "E_IQA_Intra0(A)": -0.43136050805,
            "T(A)": 0.61692221278,
            "VC_IQA(A)": -0.83309397606,
            "VC_IQA(A,A')/2": 0.018614737507,
            "VC_IQA(A,A)": -0.85170871356,
            "VX_IQA(A)": -0.36974692134,
            "VX_IQA(A,A')/2": -0.14720277066,
            "VX_IQA(A,A)": -0.22254415068,
            "V_IQA(A)": -1.2028408974,
            "V_IQA(A,A')/2": -0.12858803315,
            "V_IQA(A,A)": -1.0742528642,
            "Vee(A,A')/2": 2.4637260987,
            "Vee(A,A)": 0.19640181077,
            "Vee(A,A) + Vee(A,A')/2": 2.6601279095,
            "Vee0(A,A')/2": 2.4637260987,
            "Vee0(A,A)": 0.22237195418,
            "Vee0(A,A) + Vee0(A,A')/2": 2.6860980529,
            "VeeC(A,A')/2": 2.6109288693,
            "VeeC(A,A)": 0.41894596145,
            "VeeC(A,A) + VeeC(A,A')/2": 3.0298748308,
            "VeeX(A,A')/2": -0.14720277066,
            "VeeX(A,A)": -0.22254415068,
            "VeeX(A,A) + VeeX(A,A')/2": -0.36974692134,
            "VeeX0(A,A')/2": -0.14720277066,
            "VeeX0(A,A)": -0.19657400727,
            "VeeX0(A,A) + VeeX0(A,A')/2": -0.34377677792,
            "Ven(A,A')/2": -2.6670643866,
            "Ven(A,Mol)/2": -3.3023917241,
            "Vne(A,A')/2": -2.7881098552,
            "Vne(A,Mol)/2": -3.4234371927,
            "Vneen(A,A')/2": -5.4551742418,
            "Vneen(A,A)/2 = Vne(A,A)": -1.270654675,
            "Vneen(A,Mol)/2": -6.7258289169,
            "Vnn(A,Mol)/2": 2.86286011,
        },
        "H6": {
            "E_IQA(A)": -0.48306665702,
            "E_IQA0(A)": -0.47032369043,
            "E_IQA_Inter(A)": -0.19267139501,
            "E_IQA_Inter0(A)": -0.19267139501,
            "E_IQA_Intra(A)": -0.29039526201,
            "E_IQA_Intra0(A)": -0.27765229542,
            "T(A)": 0.35127202275,
            "VC_IQA(A)": -0.68168900425,
            "VC_IQA(A,A')/2": -0.095172223617,
            "VC_IQA(A,A)": -0.58651678063,
            "VX_IQA(A)": -0.15264967552,
            "VX_IQA(A,A')/2": -0.097499171392,
            "VX_IQA(A,A)": -0.055150504128,
            "V_IQA(A)": -0.83433867977,
            "V_IQA(A,A')/2": -0.19267139501,
            "V_IQA(A,A)": -0.64166728476,
            "Vee(A,A')/2": 1.079096259,
            "Vee(A,A)": 0.036265179983,
            "Vee(A,A) + Vee(A,A')/2": 1.1153614389,
            "Vee0(A,A')/2": 1.079096259,
            "Vee0(A,A)": 0.04900814657,
            "Vee0(A,A) + Vee0(A,A')/2": 1.1281044055,
            "VeeC(A,A')/2": 1.1765954303,
            "VeeC(A,A)": 0.091415684111,
            "VeeC(A,A) + VeeC(A,A')/2": 1.2680111145,
            "VeeX(A,A')/2": -0.097499171392,
            "VeeX(A,A)": -0.055150504128,
            "VeeX(A,A) + VeeX(A,A')/2": -0.15264967552,
            "VeeX0(A,A')/2": -0.097499171392,
            "VeeX0(A,A)": -0.042407537541,
            "VeeX0(A,A) + VeeX0(A,A')/2": -0.13990670893,
            "Ven(A,A')/2": -1.1199199339,
            "Ven(A,Mol)/2": -1.4588861663,
            "Vne(A,A')/2": -3.3223815072,
            "Vne(A,Mol)/2": -3.6613477396,
            "Vneen(A,A')/2": -4.4423014411,
            "Vneen(A,A)/2 = Vne(A,A)": -0.67793246474,
            "Vneen(A,Mol)/2": -5.1202339059,
            "Vnn(A,Mol)/2": 3.1705337872,
        },
        "O3": {
            "E_IQA(A)": -75.433613432,
            "E_IQA0(A)": -75.038306919,
            "E_IQA_Inter(A)": -0.59666127061,
            "E_IQA_Inter0(A)": -0.59666127061,
            "E_IQA_Intra(A)": -74.836952161,
            "E_IQA_Intra0(A)": -74.441645648,
            "T(A)": 75.027395266,
            "VC_IQA(A)": -141.45924388,
            "VC_IQA(A,A')/2": -0.35027724824,
            "VC_IQA(A,A)": -141.10896663,
            "VX_IQA(A)": -9.0017648219,
            "VX_IQA(A,A')/2": -0.24638402237,
            "VX_IQA(A,A)": -8.7553807995,
            "V_IQA(A)": -150.4610087,
            "V_IQA(A,A')/2": -0.59666127061,
            "V_IQA(A,A)": -149.86434743,
            "Vee(A,A')/2": 12.495576396,
            "Vee(A,A)": 34.227898457,
            "Vee(A,A) + Vee(A,A')/2": 46.723474853,
            "Vee0(A,A')/2": 12.495576396,
            "Vee0(A,A)": 34.62320497,
            "Vee0(A,A) + Vee0(A,A')/2": 47.118781366,
            "VeeC(A,A')/2": 12.741960419,
            "VeeC(A,A)": 42.983279256,
            "VeeC(A,A) + VeeC(A,A')/2": 55.725239675,
            "VeeX(A,A')/2": -0.24638402237,
            "VeeX(A,A)": -8.7553807995,
            "VeeX(A,A) + VeeX(A,A')/2": -9.0017648219,
            "VeeX0(A,A')/2": -0.24638402237,
            "VeeX0(A,A)": -8.3600742863,
            "VeeX0(A,A) + VeeX0(A,A')/2": -8.6064583087,
            "Ven(A,A')/2": -15.982431788,
            "Ven(A,Mol)/2": -108.02855473,
            "Vne(A,A')/2": -11.222434412,
            "Vne(A,Mol)/2": -103.26855735,
            "Vneen(A,A')/2": -27.204866199,
            "Vneen(A,A)/2 = Vne(A,A)": -184.09224588,
            "Vneen(A,Mol)/2": -211.29711208,
            "Vnn(A,Mol)/2": 14.112628532,
        },
    }

    _test_ints(
        int_dir_path=ints_dir_path,
        atom_name={
            "C1": "C1",
            "H2": "H2",
            "O3": "O3",
            "H4": "H4",
            "H5": "H5",
            "H6": "H6",
        },
        atom_num={"C1": 1, "H2": 2, "O3": 3, "H4": 4, "H5": 5, "H6": 6},
        title={
            "C1": "METHANOL_AMBER1000K0",
            "H2": "METHANOL_AMBER1000K0",
            "O3": "METHANOL_AMBER1000K0",
            "H4": "METHANOL_AMBER1000K0",
            "H5": "METHANOL_AMBER1000K0",
            "H6": "METHANOL_AMBER1000K0",
        },
        dft_model={
            "C1": "Restricted B3LYP",
            "H2": "Restricted B3LYP",
            "O3": "Restricted B3LYP",
            "H4": "Restricted B3LYP",
            "H5": "Restricted B3LYP",
            "H6": "Restricted B3LYP",
        },
        basin_integration_results={
            "C1": {
                "N": 5.457160936,
                "G": 37.243453089,
                "K": 37.243325182,
                "L": -0.00012790669508,
                "WeizKE": 30.38156886,
                "TFKE": 33.629384008,
                "I": 1.0658987535,
                "<Rho/r**2>": 136.5315659,
                "<Rho/r>": 14.554983112,
                "<Rho*r>": 5.2366290107,
                "<Rho*r**2>": 7.7663232897,
                "<Rho*r**4>": 31.619650636,
                "GR(-2)": -134.93683828,
                "GR(-1)": -26.642078089,
                "GR0": -12.303712535,
                "GR1": -13.757164071,
                "GR2": -25.071415774,
                "VenO": -87.329898672,
                "VenT": -111.5563367,
                "Dipole X": 0.48495495846,
                "Dipole Y": -0.088675344388,
                "Dipole Z": -0.35756588345,
                "|Dipole|": 0.60901394849,
            },
            "H2": {
                "N": 1.0020682526,
                "G": 0.59706131492,
                "K": 0.59707321472,
                "L": 1.1899800117e-05,
                "WeizKE": 0.52067998764,
                "TFKE": 0.53552847262,
                "I": 0.33194247133,
                "<Rho/r**2>": 2.819912376,
                "<Rho/r>": 1.2516525659,
                "<Rho*r>": 1.1526264312,
                "<Rho*r**2>": 1.7798645754,
                "<Rho*r**4>": 9.0091280907,
                "GR(-2)": -2.2183023471,
                "GR(-1)": -1.8344539953,
                "GR0": -2.1965361306,
                "GR1": -3.5096124874,
                "GR2": -7.157503294,
                "VenO": -1.2516525659,
                "VenT": -6.3994516937,
                "Dipole X": 0.1180918724,
                "Dipole Y": -0.0738118282,
                "Dipole Z": 0.06892703758,
                "|Dipole|": 0.1553860123,
            },
            "O3": {
                "N": 9.1395979259,
                "G": 75.027380614,
                "K": 75.027395266,
                "L": 1.4652339007e-05,
                "WeizKE": 56.416456093,
                "TFKE": 68.298138732,
                "I": 1.7437518848,
                "<Rho/r**2>": 255.14933405,
                "<Rho/r>": 23.011530736,
                "<Rho*r>": 9.4063355989,
                "<Rho*r**2>": 14.400016342,
                "<Rho*r**4>": 65.083490617,
                "GR(-2)": -254.38780343,
                "GR(-1)": -44.549648133,
                "GR0": -24.493421514,
                "GR1": -31.625676166,
                "GR2": -59.168257527,
                "VenO": -184.09224588,
                "VenT": -216.05710946,
                "Dipole X": 0.057997397409,
                "Dipole Y": 0.049125421029,
                "Dipole Z": 0.13401606796,
                "|Dipole|": 0.15406917787,
            },
            "H4": {
                "N": 0.99483161085,
                "G": 0.60632285703,
                "K": 0.6063389124,
                "L": 1.6055368633e-05,
                "WeizKE": 0.53256922358,
                "TFKE": 0.5490728082,
                "I": 0.32686610674,
                "<Rho/r**2>": 2.8777533976,
                "<Rho/r>": 1.2622876822,
                "<Rho*r>": 1.1250256692,
                "<Rho*r**2>": 1.70808964,
                "<Rho*r**4>": 8.4029025466,
                "GR(-2)": -2.247572169,
                "GR(-1)": -1.8406733748,
                "GR0": -2.1741363038,
                "GR1": -3.4174140959,
                "GR2": -6.8490803504,
                "VenO": -1.2622876822,
                "VenT": -6.4259965198,
                "Dipole X": 0.062536322511,
                "Dipole Y": 0.11768163672,
                "Dipole Z": -0.061850406127,
                "|Dipole|": 0.1469191342,
            },
            "H5": {
                "N": 0.99227624379,
                "G": 0.61689643987,
                "K": 0.61692221278,
                "L": 2.5772907652e-05,
                "WeizKE": 0.53334414083,
                "TFKE": 0.55822346953,
                "I": 0.32370887475,
                "<Rho/r**2>": 2.911458585,
                "<Rho/r>": 1.270654675,
                "<Rho*r>": 1.1066243449,
                "<Rho*r**2>": 1.648912242,
                "<Rho*r**4>": 7.7444114211,
                "GR(-2)": -2.2614148567,
                "GR(-1)": -1.8357712343,
                "GR0": -2.1384208527,
                "GR1": -3.3006313816,
                "GR2": -6.4780285452,
                "VenO": -1.270654675,
                "VenT": -6.6047834483,
                "Dipole X": -0.065301786036,
                "Dipole Y": -0.073855795145,
                "Dipole Z": -0.10977823489,
                "|Dipole|": 0.14754749266,
            },
            "H6": {
                "N": 0.41410099779,
                "G": 0.35125398198,
                "K": 0.35127202275,
                "L": 1.804077047e-05,
                "WeizKE": 0.30417035734,
                "TFKE": 0.22382195626,
                "I": 0.13793874156,
                "<Rho/r**2>": 2.0851334394,
                "<Rho/r>": 0.67793246474,
                "<Rho*r>": 0.39321731042,
                "<Rho*r**2>": 0.52993216684,
                "<Rho*r**4>": 2.1096846512,
                "GR(-2)": -1.3783755402,
                "GR(-1)": -0.92002171003,
                "GR0": -0.91960285898,
                "GR1": -1.2665011669,
                "GR2": -2.259577981,
                "VenO": -0.67793246474,
                "VenT": -2.9177723325,
                "Dipole X": 0.032679729575,
                "Dipole Y": 0.048139646835,
                "Dipole Z": 0.15360804702,
                "|Dipole|": 0.1642584014,
            },
        },
        integration_error={
            "C1": -0.00012790669508,
            "H2": 1.1899800117e-05,
            "O3": 1.4652339007e-05,
            "H4": 1.6055368633e-05,
            "H5": 2.5772907652e-05,
            "H6": 1.804077047e-05,
        },
        critical_points=reference_critical_points,
        bond_critical_points=reference_bond_critical_points,
        ring_critical_points={
            "C1": [],
            "H2": [],
            "O3": [],
            "H4": [],
            "H5": [],
            "H6": [],
        },
        cage_critical_points={
            "C1": [],
            "H2": [],
            "O3": [],
            "H4": [],
            "H5": [],
            "H6": [],
        },
        properties=reference_properties,
        net_charge={
            "C1": 0.54283906397,
            "H2": -0.0020682526006,
            "O3": -1.1395979259,
            "H4": 0.0051683891523,
            "H5": 0.0077237562113,
            "H6": 0.58589900221,
        },
        global_spherical_multipoles=reference_global_spherical_multipoles,
        local_spherical_multipoles=referece_local_spherical_multipoles,
        C_matrix_dict=C_matrices_dict,
        iqa_energy_components=reference_iqa_energy_components,
        iqa={
            "C1": -38.039986449,
            "H2": -0.58793326086,
            "O3": -75.433613432,
            "H4": -0.58903652354,
            "H5": -0.58591868462,
            "H6": -0.48306665702,
        },
        e_intra={
            "C1": -37.437147022,
            "H2": -0.46097861755,
            "O3": -74.836952161,
            "H4": -0.46115204392,
            "H5": -0.45733065147,
            "H6": -0.29039526201,
        },
        q={
            "C1": 0.54283906397,
            "H2": -0.0020682526006,
            "O3": -1.1395979259,
            "H4": 0.0051683891523,
            "H5": 0.0077237562113,
            "H6": 0.58589900221,
        },
        q00={
            "C1": 0.54283906397,
            "H2": -0.0020682526006,
            "O3": -1.1395979259,
            "H4": 0.0051683891523,
            "H5": 0.0077237562113,
            "H6": 0.58589900221,
        },
        dipole_mag={
            "C1": 0.6090139484811902,
            "H2": 0.15538601230071813,
            "O3": 0.1540691778681036,
            "H4": 0.14691913419419778,
            "H5": 0.1475474926644155,
            "H6": 0.16425840140398357,
        },
        total_time={"C1": 42, "H2": 12, "O3": 44, "H4": 12, "H5": 12, "H6": 9},
    )
