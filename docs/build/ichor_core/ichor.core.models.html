<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ichor.core.models package &mdash; ichor 3.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->

        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ichor.core.models.kernels package" href="ichor.core.models.kernels.html" />
    <link rel="prev" title="ichor.core.files.xyz package" href="ichor.core.files.xyz.html" />
</head>

<body class="wy-body-for-nav">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



          <a href="../index.html" class="icon icon-home">
            ichor
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installing ichor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ichor_core_examples_toc.html">Examples for ichor.core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ichor_hpc_examples_toc.html">Examples for ichor.hpc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ichor_cli_examples_toc.html">Examples for ichor.cli</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">full documentation of source code</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="ichor.core.html">ichor.core package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="ichor.core.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ichor.core.analysis.html">ichor.core.analysis package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ichor.core.atoms.html">ichor.core.atoms package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ichor.core.calculators.html">ichor.core.calculators package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ichor.core.common.html">ichor.core.common package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ichor.core.daemon.html">ichor.core.daemon package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ichor.core.files.html">ichor.core.files package</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">ichor.core.models package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-ichor.core.models.calculate_fflux_derivatives">ichor.core.models.calculate_fflux_derivatives module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-ichor.core.models.create_datasets">ichor.core.models.create_datasets module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-ichor.core.models.fflux_derivative_helper_functions">ichor.core.models.fflux_derivative_helper_functions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-ichor.core.models.gaussian_energy_derivative_wrt_features">ichor.core.models.gaussian_energy_derivative_wrt_features module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-ichor.core.models.model">ichor.core.models.model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-ichor.core.models.models">ichor.core.models.models module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-ichor.core.models.predict_forces_for_all_atoms">ichor.core.models.predict_forces_for_all_atoms module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-ichor.core.models">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ichor.core.molecular_dynamics.html">ichor.core.molecular_dynamics package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ichor.core.multipoles.html">ichor.core.multipoles package</a></li>
<li class="toctree-l3"><a class="reference internal" href="ichor.core.useful_functions.html">ichor.core.useful_functions package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ichor.core.html#module-ichor.core">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ichor_hpc/ichor.hpc.html">ichor.hpc package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ichor_cli/ichor.cli.html">ichor.cli package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ichor</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="ichor.core.html">ichor.core package</a></li>
      <li class="breadcrumb-item active">ichor.core.models package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/ichor_core/ichor.core.models.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <section id="ichor-core-models-package">
<h1>ichor.core.models package<a class="headerlink" href="#ichor-core-models-package" title="Permalink to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="ichor.core.models.kernels.html">ichor.core.models.kernels package</a></li>
<li class="toctree-l1"><a class="reference internal" href="ichor.core.models.mean.html">ichor.core.models.mean package</a></li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-ichor.core.models.calculate_fflux_derivatives">
<span id="ichor-core-models-calculate-fflux-derivatives-module"></span><h2>ichor.core.models.calculate_fflux_derivatives module<a class="headerlink" href="#module-ichor.core.models.calculate_fflux_derivatives" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.calculate_fflux_derivatives.fflux_derivs">
<span class="sig-name descname"><span class="pre">fflux_derivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_inst</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.calculate_fflux_derivatives.fflux_derivs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.calculate_fflux_derivatives.fflux_derivs_da_df_matrix">
<span class="sig-name descname"><span class="pre">fflux_derivs_da_df_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.calculate_fflux_derivatives.fflux_derivs_da_df_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.calculate_fflux_derivatives.fflux_derivs_rbf_only">
<span class="sig-name descname"><span class="pre">fflux_derivs_rbf_only</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_inst</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.calculate_fflux_derivatives.fflux_derivs_rbf_only" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.calculate_fflux_derivatives.fflux_derivs_rbf_only_one_dimensional">
<span class="sig-name descname"><span class="pre">fflux_derivs_rbf_only_one_dimensional</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_inst</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.calculate_fflux_derivatives.fflux_derivs_rbf_only_one_dimensional" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.calculate_fflux_derivatives.fflux_predict_value">
<span class="sig-name descname"><span class="pre">fflux_predict_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_inst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_x_features</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.calculate_fflux_derivatives.fflux_predict_value" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.calculate_fflux_derivatives.fflux_predict_value_rbf_only">
<span class="sig-name descname"><span class="pre">fflux_predict_value_rbf_only</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_inst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_x_features</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.calculate_fflux_derivatives.fflux_predict_value_rbf_only" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-ichor.core.models.create_datasets">
<span id="ichor-core-models-create-datasets-module"></span><h2>ichor.core.models.create_datasets module<a class="headerlink" href="#module-ichor.core.models.create_datasets" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.create_datasets.get_atom_name_and_alf_from_csv">
<span class="sig-name descname"><span class="pre">get_atom_name_and_alf_from_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#ichor.core.models.create_datasets.get_atom_name_and_alf_from_csv" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to get atom name and alf (as list of str)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>csv_path</strong> – The csv file path</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the atom name and alf</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.create_datasets.write_csvs_intersection">
<span class="sig-name descname"><span class="pre">write_csvs_intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'processed_csvs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'processed_csvs_intersection'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.create_datasets.write_csvs_intersection" title="Permalink to this definition"></a></dt>
<dd><p>Not all processed atom csvs might contain the same points. This is because
one atom might in a point might be filtered because of integration error but another
one might not. This function is used to write out datasets that enforce that all atoms
in a point are present in the written out csvs. The function finds the
intersection of all point names across the csvs and then only writes out the
rows from each csv that are in the intersection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dir</strong> – The path to the directory containing processed csvs files, defaults to “processed_csvs”</p></li>
<li><p><strong>output_dir</strong> – The path to the directory containing output csvs, defaults to “processed_csvs_all_atoms”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.create_datasets.write_multiple_incremeting_train_sets_and_one_test_set">
<span class="sig-name descname"><span class="pre">write_multiple_incremeting_train_sets_and_one_test_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ntrain_initial</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntrain_increment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nincrements</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntest</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">processed_csvs_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'processed_csvs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('sets')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.create_datasets.write_multiple_incremeting_train_sets_and_one_test_set" title="Permalink to this definition"></a></dt>
<dd><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The function assumes that csvs contain ALL the same points in them.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If there are 0 increments, then it will only make one training set and one test set
containing random points (points in the training set are NOT in the test set).</p>
</div>
<p>Function used to generate (multiple)training sets and one test set. The training sets contain
an increasing number of training points, where bigger training sets contain the smaller training sets
in them already. The test set contains points that are outside of the training sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ntrain_initial</strong> – smallest possible training set size</p></li>
<li><p><strong>ntrain_increment</strong> – how much to increase the training set size by</p></li>
<li><p><strong>nincrements</strong> – how many times to increase the training set size</p></li>
<li><p><strong>ntest</strong> – number of test set points</p></li>
<li><p><strong>processed_csvs_dir</strong> – Location of processed csvs containing sample set, defaults to “processed_csvs”</p></li>
<li><p><strong>set_path</strong> – The output directory which will contain the train/test sets, defaults to Path(“sets”)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if the training+test set size is above the sample set size</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.create_datasets.write_random_train_test_sets">
<span class="sig-name descname"><span class="pre">write_random_train_test_sets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ntrain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntest</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">processed_csvs_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'processed_csvs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('sets')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.create_datasets.write_random_train_test_sets" title="Permalink to this definition"></a></dt>
<dd><p>Writes out a random training and test set</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ntrain</strong> – Number of training points</p></li>
<li><p><strong>ntest</strong> – Number of test points</p></li>
<li><p><strong>processed_csvs_dir</strong> – Directory with sample set csv files, defaults to “processed_csvs”</p></li>
<li><p><strong>set_path</strong> – Directory where train/test csvs are going to be written, defaults to Path(“sets”)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-ichor.core.models.fflux_derivative_helper_functions">
<span id="ichor-core-models-fflux-derivative-helper-functions-module"></span><h2>ichor.core.models.fflux_derivative_helper_functions module<a class="headerlink" href="#module-ichor.core.models.fflux_derivative_helper_functions" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.C_1">
<span class="sig-name descname"><span class="pre">C_1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.C_1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.C_2">
<span class="sig-name descname"><span class="pre">C_2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.C_2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.C_3">
<span class="sig-name descname"><span class="pre">C_3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.C_3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.C_matrix">
<span class="sig-name descname"><span class="pre">C_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.C_matrix" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.EqC12">
<span class="sig-name descname"><span class="pre">EqC12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.EqC12" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.dC1k_da">
<span class="sig-name descname"><span class="pre">dC1k_da</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.dC1k_da" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.dC2k_da">
<span class="sig-name descname"><span class="pre">dC2k_da</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.dC2k_da" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.dC3k_da">
<span class="sig-name descname"><span class="pre">dC3k_da</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c1_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc1k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc2k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.dC3k_da" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.dChi_da">
<span class="sig-name descname"><span class="pre">dChi_da</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.dChi_da" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.dPhi_da">
<span class="sig-name descname"><span class="pre">dPhi_da</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeta1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeta2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_feat_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.dPhi_da" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.dR_da">
<span class="sig-name descname"><span class="pre">dR_da</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.dR_da" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.dRaxdotRax_da">
<span class="sig-name descname"><span class="pre">dRaxdotRax_da</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.dRaxdotRax_da" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.dRaxdotRaxy_da">
<span class="sig-name descname"><span class="pre">dRaxdotRaxy_da</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.dRaxdotRaxy_da" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.dTheta_da">
<span class="sig-name descname"><span class="pre">dTheta_da</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_feat_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeta3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.dTheta_da" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.dZj_da">
<span class="sig-name descname"><span class="pre">dZj_da</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.dZj_da" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.delta_An">
<span class="sig-name descname"><span class="pre">delta_An</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.delta_An" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.delta_Ax">
<span class="sig-name descname"><span class="pre">delta_Ax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.delta_Ax" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.delta_Axy">
<span class="sig-name descname"><span class="pre">delta_Axy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.delta_Axy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.dsigma_da">
<span class="sig-name descname"><span class="pre">dsigma_da</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.dsigma_da" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.dyj_da">
<span class="sig-name descname"><span class="pre">dyj_da</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.dyj_da" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.kronecker">
<span class="sig-name descname"><span class="pre">kronecker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.kronecker" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.sigma_fflux">
<span class="sig-name descname"><span class="pre">sigma_fflux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_axis_diff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_plane_diff</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.sigma_fflux" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.sign_j">
<span class="sig-name descname"><span class="pre">sign_j</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fdiff</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.sign_j" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.fflux_derivative_helper_functions.y_vec">
<span class="sig-name descname"><span class="pre">y_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iatm_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.fflux_derivative_helper_functions.y_vec" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-ichor.core.models.gaussian_energy_derivative_wrt_features">
<span id="ichor-core-models-gaussian-energy-derivative-wrt-features-module"></span><h2>ichor.core.models.gaussian_energy_derivative_wrt_features module<a class="headerlink" href="#module-ichor.core.models.gaussian_energy_derivative_wrt_features" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.gaussian_energy_derivative_wrt_features.convert_to_cartesian_forces">
<span class="sig-name descname"><span class="pre">convert_to_cartesian_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dE_df_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ichor.core.atoms.html#ichor.core.atoms.alf.ALF" title="ichor.core.atoms.alf.ALF"><span class="pre">ALF</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_atom_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.gaussian_energy_derivative_wrt_features.convert_to_cartesian_forces" title="Permalink to this definition"></a></dt>
<dd><p>Converts from local ‘feature’ forces to global Cartesian forces, as given by Gaussian.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dE_df_array</strong> – 1D array of shape n_features x 1 containing ‘feature’ forces.</p></li>
<li><p><strong>b_matrix</strong> – Wilson B matrix to be used to calculate, as well as dE/df. Should be of shape
(3N-6) x 3N where N is the number of atoms.</p></li>
<li><p><strong>system_alf</strong> – A list of ALF instances containing the ALF of every atom.</p></li>
<li><p><strong>central_atom_idx</strong> – The index of the atom (0-indexed) which was the central ALF atom for which
features (and feature derivatives) were calculated.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.gaussian_energy_derivative_wrt_features.convert_to_feature_forces">
<span class="sig-name descname"><span class="pre">convert_to_feature_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_cartesian_forces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_atom_idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.gaussian_energy_derivative_wrt_features.convert_to_feature_forces" title="Permalink to this definition"></a></dt>
<dd><p>Compute -dE/df (since the global Cartesian forces are negative of the derivative of the potential).
If making models with these values, need to take the NEGATIVE of -dE/df, as the
derivative of the potential energy is dE/df.</p>
<p>dE/df are the values that need to be used when adding derivatives to GP model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>global_cartesian_forces</strong> – A 2D numpy array of shape (N_atoms, 3) containing the global Cartesian forces.
The rows of this array are swapped internally to match the rows of the b-matrix.</p></li>
<li><p><strong>b_matrix</strong> – Wilson B matrix to be used to calculate, as well as dE/df. Should be of shape
(3N-6) x 3N where N is the number of atoms.</p></li>
<li><p><strong>system_alf</strong> – A list of ALF instances containing the ALF of every atom.</p></li>
<li><p><strong>central_atom_idx</strong> – The index of the atom (0-indexed) which was the central ALF atom for which
features (and feature derivatives) were calculated.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ordering of the forces should match up with the ordering of the b_matrix.</p>
</div>
<p>See Using Redundant Internal Coordinates to Optimize Equilibrium Geometries and Transition States
<a class="reference external" href="https://doi.org/10.1002/(SICI)1096-987X(19960115)17">https://doi.org/10.1002/(SICI)1096-987X(19960115)17</a>:1&lt;49::AID-JCC5&gt;3.0.CO;2-0
<a class="reference external" href="https://doi.org/10.1063/1.462844">https://doi.org/10.1063/1.462844</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.gaussian_energy_derivative_wrt_features.form_b_matrix">
<span class="sig-name descname"><span class="pre">form_b_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ichor.core.atoms.html#ichor.core.atoms.atoms.Atoms" title="ichor.core.atoms.atoms.Atoms"><span class="pre">Atoms</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ichor.core.atoms.html#ichor.core.atoms.alf.ALF" title="ichor.core.atoms.alf.ALF"><span class="pre">ALF</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_atom_idx</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#ichor.core.models.gaussian_energy_derivative_wrt_features.form_b_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Returns a np array of shape <code class="docutils literal notranslate"><span class="pre">n_features</span></code> x <code class="docutils literal notranslate"><span class="pre">n_atomsx3</span></code>, containing the derivative of
features with respect to x,y,z coordiantes.</p>
<div class="math notranslate nohighlight">
\[B_{ij} = \frac{df_i}{dx_j}\]</div>
<p>where the partial derivative of feature i <span class="math notranslate nohighlight">\(f_i\)</span> wrt.
partial derivative of global Cartesian <span class="math notranslate nohighlight">\(x_j\)</span>.</p>
<p>See the following papers for details:</p>
<p>Using redundant internal coordinates to optimize equilibrium geometries and transition states:</p>
<p><a class="reference external" href="https://doi.org/10.1002/(SICI)1096-987X(19960115)17:1&lt;49::AID-JCC5&gt;3.0.CO;2-0">link1</a></p>
<p>Geometry optimization in redundant internal coordinates:</p>
<p><a class="reference external" href="https://doi.org/10.1063/1.462844">link2</a></p>
<p>The first three columns of the B-matrix are for atom <span class="math notranslate nohighlight">\(A_0\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\frac{df_i}{dA^0_x}, \frac{df_i}{dA^0_y}, \frac{df_i}{dA^0_z}\)</span></p>
<p>The next three columns of the B-matrix are for atom <span class="math notranslate nohighlight">\(A_x\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\frac{df_i}{dA^x_x}, \frac{df_i}{dA^x_y}, \frac{df_i}{dA^x_z}\)</span></p>
<p>The next three columns of the B-matrix are for atom <span class="math notranslate nohighlight">\(A^{xy}\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\frac{df_i}{dA^{xy}_x}, \frac{df_i}{dA^{xy}_y}, \frac{df_i}{dA^{xy}_z}\)</span></p>
<p>The subsequent sets of three columns of the B-matrix are for atom <span class="math notranslate nohighlight">\(A^n\)</span>.
which are atoms described by r, theta, phi.</p>
<p><span class="math notranslate nohighlight">\(\frac{df_i}{dA^n_x}, \frac{df_i}{dA^n_y}, \frac{df_i}{dA^n_z}\)</span></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The atoms instance is converted to Bohr internally because the forces are per Bohr in FFLUX.
Also the <cite>system_alf</cite> argument is 0-indexed (as calculated by ichor methods),
while the ALF in the .model files is 1-indexed.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> – The Atoms instance for which to calculate the Wilson B matrix.
The B matrix is calculated from the coordinates of the atoms.</p></li>
<li><p><strong>system_alf</strong> – The system alf as a list of <cite>ALF</cite> instances (the <cite>ALF</cite> instances are just a named tuple
containing origin_idx, x-axis_idx, xy_plane_idx. It is 0-indexed.)</p></li>
<li><p><strong>index</strong> (<em>central atom</em>) – The index of the atom to be used as the central atom. Therefore,
the derivatives df_i / dx_j are going to be for the features of this atom.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.gaussian_energy_derivative_wrt_features.form_g_inverse">
<span class="sig-name descname"><span class="pre">form_g_inverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.gaussian_energy_derivative_wrt_features.form_g_inverse" title="Permalink to this definition"></a></dt>
<dd><p>Inverts the G matrix, gives generalized inverse</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.gaussian_energy_derivative_wrt_features.form_g_matrix">
<span class="sig-name descname"><span class="pre">form_g_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.gaussian_energy_derivative_wrt_features.form_g_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Forms the G matrix as in Gaussian.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The general inverse of G is NOT used here. Gaussian seems to use
the regular inverse (so this is why np.linalg.inv is used,
but can use Chloesky or something like this instead because
G is a symmetric square (BuB^T, where u is the identity matrix here))</p>
</div>
</dd></dl>

</section>
<section id="module-ichor.core.models.model">
<span id="ichor-core-models-model-module"></span><h2>ichor.core.models.model module<a class="headerlink" href="#module-ichor.core.models.model" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ichor.core.models.model.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path:</span> <span class="pre">~pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_name:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_name:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alf:</span> <span class="pre">~ichor.core.atoms.alf.ALF</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natoms:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntrain:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfeats:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean:</span> <span class="pre">~ichor.core.models.mean.mean.Mean</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel:</span> <span class="pre">~ichor.core.models.kernels.kernel.Kernel</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_units:</span> <span class="pre">~typing.List[str]</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_unit:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">program:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">program_version:</span> <span class="pre">~ichor.core.common.types.version.Version</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notes:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str]</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.model.Model" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="ichor.core.files.html#ichor.core.files.file.ReadFile" title="ichor.core.files.file.ReadFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReadFile</span></code></a>, <a class="reference internal" href="ichor.core.files.html#ichor.core.files.file.WriteFile" title="ichor.core.files.file.WriteFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">WriteFile</span></code></a></p>
<p>A model file that is returned back from our machine learning program FEREBUS.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Another program can be used for the machine learning as
long as it outputs files of the same format as the FEREBUS outputs.</p>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.model.Model.R">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">R</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#ichor.core.models.model.Model.R" title="Permalink to this definition"></a></dt>
<dd><p>Returns the covariance matrix and adds a jitter
to the diagonal for numerical stability. This jitter is a very
small number on the order of 1e-6 to 1e-10.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.model.Model.atom">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atom</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ichor.core.models.model.Model.atom" title="Permalink to this definition"></a></dt>
<dd><p>alias for atom_name</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.model.Model.atom_num">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atom_num</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ichor.core.models.model.Model.atom_num" title="Permalink to this definition"></a></dt>
<dd><p>Returns the integer that is in the atom name</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.model.Model.compute_likelihood">
<span class="sig-name descname"><span class="pre">compute_likelihood</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#ichor.core.models.model.Model.compute_likelihood" title="Permalink to this definition"></a></dt>
<dd><p>Computes the marginal likelihood from the data given</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.model.Model.compute_weights">
<span class="sig-name descname"><span class="pre">compute_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#ichor.core.models.model.Model.compute_weights" title="Permalink to this definition"></a></dt>
<dd><p>Computes the training weights from the data given</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ichor.core.models.model.Model.filetype">
<span class="sig-name descname"><span class="pre">filetype</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'.model'</span></em><a class="headerlink" href="#ichor.core.models.model.Model.filetype" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.model.Model.i">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">i</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ichor.core.models.model.Model.i" title="Permalink to this definition"></a></dt>
<dd><p>Returns the integer that is one less than the one in the atom name.
This is the index of the atom in Python objects such as lists (as indeces start at 0).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.model.Model.ialf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ialf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#ichor.core.models.model.Model.ialf" title="Permalink to this definition"></a></dt>
<dd><p>Returns the atomic local frame, indices start at 0 (as in Python).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The 0-indexed np.ndarray corresponding to the alf of the atom.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.model.Model.invR">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">invR</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#ichor.core.models.model.Model.invR" title="Permalink to this definition"></a></dt>
<dd><p>Returns the inverse of the covariance matrix R</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.model.Model.logdet">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">logdet</span></span><a class="headerlink" href="#ichor.core.models.model.Model.logdet" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.model.Model.lower_cholesky">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lower_cholesky</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#ichor.core.models.model.Model.lower_cholesky" title="Permalink to this definition"></a></dt>
<dd><p>Decomposes the covariance matrix into L and L^T. Returns the lower triangular matrix L.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.model.Model.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#ichor.core.models.model.Model.predict" title="Permalink to this definition"></a></dt>
<dd><p>Returns an array containing the test point predictions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.model.Model.r">
<span class="sig-name descname"><span class="pre">r</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#ichor.core.models.model.Model.r" title="Permalink to this definition"></a></dt>
<dd><p>Returns the n_train by n_test covariance matrix</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.model.Model.type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ichor.core.models.model.Model.type" title="Permalink to this definition"></a></dt>
<dd><p>alias for prop</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.model.Model.variance">
<span class="sig-name descname"><span class="pre">variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#ichor.core.models.model.Model.variance" title="Permalink to this definition"></a></dt>
<dd><p>Return the variance for the test data points.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-ichor.core.models.models">
<span id="ichor-core-models-models-module"></span><h2>ichor.core.models.models module<a class="headerlink" href="#module-ichor.core.models.models" title="Permalink to this heading"></a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="ichor.core.models.models.DimensionError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DimensionError</span></span><a class="headerlink" href="#ichor.core.models.models.DimensionError" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ichor.core.models.models.Models">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.models.Models" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="ichor.core.files.html#ichor.core.files.directory.Directory" title="ichor.core.files.directory.Directory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Directory</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></p>
<p>A class which wraps around a directory containing models made by FEREBUS
or any other program used to make GP models. There are different
models for iqa energy and each individual multipole moment. Aditionally,
every atom in the system has its own set of models for iqa and
multipole moments. These models can have different training input/output data
if the models have been made with per-atom.</p>
<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.models.Models.alf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">alf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ichor.core.atoms.html#ichor.core.atoms.alf.ALF" title="ichor.core.atoms.alf.ALF"><span class="pre">ALF</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ichor.core.models.models.Models.alf" title="Permalink to this definition"></a></dt>
<dd><p>Returns the alf taken straight from each model file e.g. [[1, 2, 3], [2, 1, 3], [3, 1, 2]]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.models.Models.atom_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atom_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ichor.core.models.models.Models.atom_names" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of atom names (such as O1, H2, H3, etc.) for which models were made</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.models.Models.check_path">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">check_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#ichor.core.models.models.Models.check_path" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.models.Models.dirpattern">
<span class="sig-name descname"><span class="pre">dirpattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.models.Models.dirpattern" title="Permalink to this definition"></a></dt>
<dd><p>A regex pattern used to find directories containing models.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.models.Models.get_features_dict">
<span class="sig-name descname"><span class="pre">get_features_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ichor.core.atoms.html#ichor.core.atoms.atoms.Atoms" title="ichor.core.atoms.atoms.Atoms"><span class="pre">Atoms</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="ichor.core.atoms.html#ichor.core.atoms.list_of_atoms.ListOfAtoms" title="ichor.core.atoms.list_of_atoms.ListOfAtoms"><span class="pre">ListOfAtoms</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="ichor.core.files.html#ichor.core.files.file_data.HasAtoms" title="ichor.core.files.file_data.HasAtoms"><span class="pre">HasAtoms</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#ichor.core.models.models.Models.get_features_dict" title="Permalink to this definition"></a></dt>
<dd><p>Returns a dictionary containing the atom names as keys and an np.ndarray of features as values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>test_x</strong> – An object that contains features (or coordinates that can be converted into features),
such as <code class="docutils literal notranslate"><span class="pre">Atoms</span></code>, <code class="docutils literal notranslate"><span class="pre">ListOfAtoms</span></code>, <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code>, <code class="docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the atom names as keys and an np.ndarray of features as values</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.models.Models.ialf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ialf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#ichor.core.models.models.Models.ialf" title="Permalink to this definition"></a></dt>
<dd><p>Returns the zero index alf from each model file as a numpy array e.g. [[0, 1, 2], [1, 0, 2], [2, 0, 1]]</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sorting by the first integer in elements of the list will give a
list like this [[0,…], [1,….], [2,….]].
Before that the list could look like [[2,…], [0,….], [1,….]]
(because the models could be unordered) which would mess up the alf for atoms.</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.models.Models.ialf_dict">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ialf_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ichor.core.models.models.Models.ialf_dict" title="Permalink to this definition"></a></dt>
<dd><p>Returns the zero index alf from each model file as a dictionary
e.g. {‘O1’: [0, 1, 2], ‘H2’: [1, 0, 2], ‘H3’: [2, 0, 1]}</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.models.Models.ntrain">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ntrain</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ichor.core.models.models.Models.ntrain" title="Permalink to this definition"></a></dt>
<dd><p>Returns the maximum number of training points that were used for a model in this <cite>Models</cite> instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.models.Models.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ichor.core.models.models.Models.predict" title="Permalink to this definition"></a></dt>
<dd><p>Returns dictionary of DataFrame({“atom”: {“property”: [values]}})</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.models.Models.system">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">system</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ichor.core.models.models.Models.system" title="Permalink to this definition"></a></dt>
<dd><p>Returns the name of the system for which models were made.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.models.Models.types">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">types</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ichor.core.models.models.Models.types" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of types (such as q00, q10, iqa, etc.) for which models were made</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.models.Models.variance">
<span class="sig-name descname"><span class="pre">variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ichor.core.models.models.Models.variance" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ichor.core.models.models.ModelsView">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ModelsView</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.models.ModelsView" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#ichor.core.models.models.Models" title="ichor.core.models.models.Models"><code class="xref py py-class docutils literal notranslate"><span class="pre">Models</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.models.x_to_features">
<span class="sig-name descname"><span class="pre">x_to_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">F</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">F</span></span></span><a class="headerlink" href="#ichor.core.models.models.x_to_features" title="Permalink to this definition"></a></dt>
<dd><p>Used as a decorator to convert an incoming set of
test points <cite>x</cite> to features because we need to know the test point features in
order to make predictions.</p>
</dd></dl>

</section>
<section id="module-ichor.core.models.predict_forces_for_all_atoms">
<span id="ichor-core-models-predict-forces-for-all-atoms-module"></span><h2>ichor.core.models.predict_forces_for_all_atoms module<a class="headerlink" href="#module-ichor.core.models.predict_forces_for_all_atoms" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.predict_forces_for_all_atoms.predict_fflux_forces_for_all_atoms">
<span class="sig-name descname"><span class="pre">predict_fflux_forces_for_all_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ichor.core.atoms.html#ichor.core.atoms.atoms.Atoms" title="ichor.core.atoms.atoms.Atoms"><span class="pre">Atoms</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ichor.core.models.models.Models" title="ichor.core.models.models.Models"><span class="pre">Models</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ichor.core.atoms.html#ichor.core.atoms.alf.ALF" title="ichor.core.atoms.alf.ALF"><span class="pre">ALF</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#ichor.core.models.predict_forces_for_all_atoms.predict_fflux_forces_for_all_atoms" title="Permalink to this definition"></a></dt>
<dd><p>Predicts the forces that FFLUX predicts (which are written to IQA_FORCES file).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The atoms instance is converted to Bohr internally because the forces are per Bohr in FFLUX.
Also the <cite>system_alf</cite> argument is 0-indexed (as calcualted by ichor methods),
while the ALF in the .model files is 1-indexed.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> – An Atoms instance containing the geometry for which to predict forces.
Note that the ordering of the atoms matters, i.e. the index of the atoms in the Atoms instance
must match the index of the model files.</p></li>
<li><p><strong>models</strong> – A models instance which wraps around a directory containing model files.</p></li>
<li><p><strong>system_alf</strong> – The system alf as a list of <cite>ALF</cite> instances (the <cite>ALF</cite> instances are just a named tuple
containing origin_idx, x-axis_idx, xy_plane_idx. It is 0-indexed.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A np.ndarray of shape n_atoms x 3 containing the x,y,z force for every atom</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.predict_forces_for_all_atoms.predict_fflux_forces_for_all_atoms_dict">
<span class="sig-name descname"><span class="pre">predict_fflux_forces_for_all_atoms_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ichor.core.atoms.html#ichor.core.atoms.atoms.Atoms" title="ichor.core.atoms.atoms.Atoms"><span class="pre">Atoms</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ichor.core.models.models.Models" title="ichor.core.models.models.Models"><span class="pre">Models</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ichor.core.atoms.html#ichor.core.atoms.alf.ALF" title="ichor.core.atoms.alf.ALF"><span class="pre">ALF</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#ichor.core.models.predict_forces_for_all_atoms.predict_fflux_forces_for_all_atoms_dict" title="Permalink to this definition"></a></dt>
<dd><p>Predicts the forces that FFLUX predicts (which are written to IQA_FORCES file).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The atoms instance is converted to Bohr internally because the forces are per Bohr in FFLUX.
Also the <cite>system_alf</cite> argument is 0-indexed (as calcualted by ichor methods),
while the ALF in the .model files is 1-indexed.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> – An Atoms instance containing the geometry for which to predict forces.
Note that the ordering of the atoms matters, i.e. the index of the atoms in the Atoms instance
must match the index of the model files.</p></li>
<li><p><strong>models</strong> – A models instance which wraps around a directory containing model files.</p></li>
<li><p><strong>system_alf</strong> – The system alf as a list of <cite>ALF</cite> instances (the <cite>ALF</cite> instances are just a named tuple
containing origin_idx, x-axis_idx, xy_plane_idx. It is 0-indexed.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of key: atom_name, value: 1D np.ndarray containing the x,y,z forces on the atom.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ichor.core.models.predict_forces_for_all_atoms.predict_fflux_forces_for_all_atoms_one_dimensional">
<span class="sig-name descname"><span class="pre">predict_fflux_forces_for_all_atoms_one_dimensional</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ichor.core.atoms.html#ichor.core.atoms.atoms.Atoms" title="ichor.core.atoms.atoms.Atoms"><span class="pre">Atoms</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#ichor.core.models.models.Models" title="ichor.core.models.models.Models"><span class="pre">Models</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_alf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ichor.core.atoms.html#ichor.core.atoms.alf.ALF" title="ichor.core.atoms.alf.ALF"><span class="pre">ALF</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#ichor.core.models.predict_forces_for_all_atoms.predict_fflux_forces_for_all_atoms_one_dimensional" title="Permalink to this definition"></a></dt>
<dd><p>Predicts the forces that FFLUX predicts (which are written to IQA_FORCES file).
Note this is for special case where the system has only one feature, eg. HCl.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The atoms instance is converted to Bohr internally because the forces are per Bohr in FFLUX.
Also the <cite>system_alf</cite> argument is 0-indexed (as calcualted by ichor methods),
while the ALF in the .model files is 1-indexed.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> – An Atoms instance containing the geometry for which to predict forces.
Note that the ordering of the atoms matters, i.e. the index of the atoms in the Atoms instance
must match the index of the model files.</p></li>
<li><p><strong>models</strong> – A models instance which wraps around a directory containing model files.</p></li>
<li><p><strong>system_alf</strong> – The system alf as a list of <cite>ALF</cite> instances (the <cite>ALF</cite> instances are just a named tuple
containing origin_idx, x-axis_idx, xy_plane_idx. It is 0-indexed.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A np.ndarray of shape n_atoms x 3 containing the x,y,z force for every atom</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-ichor.core.models">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-ichor.core.models" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="ichor.core.models.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path:</span> <span class="pre">~pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_name:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_name:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alf:</span> <span class="pre">~ichor.core.atoms.alf.ALF</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natoms:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntrain:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfeats:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean:</span> <span class="pre">~ichor.core.models.mean.mean.Mean</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel:</span> <span class="pre">~ichor.core.models.kernels.kernel.Kernel</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_units:</span> <span class="pre">~typing.List[str]</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_unit:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights:</span> <span class="pre">~numpy.ndarray</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">program:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">program_version:</span> <span class="pre">~ichor.core.common.types.version.Version</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notes:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str]</span> <span class="pre">=</span> <span class="pre">&lt;ichor.core.files.file.FileContentsType</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.Model" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="ichor.core.files.html#ichor.core.files.file.ReadFile" title="ichor.core.files.file.ReadFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReadFile</span></code></a>, <a class="reference internal" href="ichor.core.files.html#ichor.core.files.file.WriteFile" title="ichor.core.files.file.WriteFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">WriteFile</span></code></a></p>
<p>A model file that is returned back from our machine learning program FEREBUS.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Another program can be used for the machine learning as
long as it outputs files of the same format as the FEREBUS outputs.</p>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.Model.R">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">R</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#ichor.core.models.Model.R" title="Permalink to this definition"></a></dt>
<dd><p>Returns the covariance matrix and adds a jitter
to the diagonal for numerical stability. This jitter is a very
small number on the order of 1e-6 to 1e-10.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.Model.atom">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atom</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ichor.core.models.Model.atom" title="Permalink to this definition"></a></dt>
<dd><p>alias for atom_name</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.Model.atom_num">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atom_num</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ichor.core.models.Model.atom_num" title="Permalink to this definition"></a></dt>
<dd><p>Returns the integer that is in the atom name</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.Model.compute_likelihood">
<span class="sig-name descname"><span class="pre">compute_likelihood</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#ichor.core.models.Model.compute_likelihood" title="Permalink to this definition"></a></dt>
<dd><p>Computes the marginal likelihood from the data given</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.Model.compute_weights">
<span class="sig-name descname"><span class="pre">compute_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#ichor.core.models.Model.compute_weights" title="Permalink to this definition"></a></dt>
<dd><p>Computes the training weights from the data given</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ichor.core.models.Model.filetype">
<span class="sig-name descname"><span class="pre">filetype</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'.model'</span></em><a class="headerlink" href="#ichor.core.models.Model.filetype" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.Model.i">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">i</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ichor.core.models.Model.i" title="Permalink to this definition"></a></dt>
<dd><p>Returns the integer that is one less than the one in the atom name.
This is the index of the atom in Python objects such as lists (as indeces start at 0).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.Model.ialf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ialf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#ichor.core.models.Model.ialf" title="Permalink to this definition"></a></dt>
<dd><p>Returns the atomic local frame, indices start at 0 (as in Python).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The 0-indexed np.ndarray corresponding to the alf of the atom.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.Model.invR">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">invR</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#ichor.core.models.Model.invR" title="Permalink to this definition"></a></dt>
<dd><p>Returns the inverse of the covariance matrix R</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.Model.logdet">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">logdet</span></span><a class="headerlink" href="#ichor.core.models.Model.logdet" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.Model.lower_cholesky">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lower_cholesky</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#ichor.core.models.Model.lower_cholesky" title="Permalink to this definition"></a></dt>
<dd><p>Decomposes the covariance matrix into L and L^T. Returns the lower triangular matrix L.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ichor.core.models.Model.path">
<span class="sig-name descname"><span class="pre">path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ichor.core.models.Model.path" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.Model.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#ichor.core.models.Model.predict" title="Permalink to this definition"></a></dt>
<dd><p>Returns an array containing the test point predictions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.Model.r">
<span class="sig-name descname"><span class="pre">r</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#ichor.core.models.Model.r" title="Permalink to this definition"></a></dt>
<dd><p>Returns the n_train by n_test covariance matrix</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.Model.type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ichor.core.models.Model.type" title="Permalink to this definition"></a></dt>
<dd><p>alias for prop</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.Model.variance">
<span class="sig-name descname"><span class="pre">variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#ichor.core.models.Model.variance" title="Permalink to this definition"></a></dt>
<dd><p>Return the variance for the test data points.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ichor.core.models.Models">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.Models" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="ichor.core.files.html#ichor.core.files.directory.Directory" title="ichor.core.files.directory.Directory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Directory</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></p>
<p>A class which wraps around a directory containing models made by FEREBUS
or any other program used to make GP models. There are different
models for iqa energy and each individual multipole moment. Aditionally,
every atom in the system has its own set of models for iqa and
multipole moments. These models can have different training input/output data
if the models have been made with per-atom.</p>
<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.Models.alf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">alf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="ichor.core.atoms.html#ichor.core.atoms.alf.ALF" title="ichor.core.atoms.alf.ALF"><span class="pre">ALF</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ichor.core.models.Models.alf" title="Permalink to this definition"></a></dt>
<dd><p>Returns the alf taken straight from each model file e.g. [[1, 2, 3], [2, 1, 3], [3, 1, 2]]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.Models.atom_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">atom_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ichor.core.models.Models.atom_names" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of atom names (such as O1, H2, H3, etc.) for which models were made</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.Models.check_path">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">check_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#ichor.core.models.Models.check_path" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.Models.dirpattern">
<span class="sig-name descname"><span class="pre">dirpattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ichor.core.models.Models.dirpattern" title="Permalink to this definition"></a></dt>
<dd><p>A regex pattern used to find directories containing models.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.Models.get_features_dict">
<span class="sig-name descname"><span class="pre">get_features_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="ichor.core.atoms.html#ichor.core.atoms.atoms.Atoms" title="ichor.core.atoms.atoms.Atoms"><span class="pre">Atoms</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="ichor.core.atoms.html#ichor.core.atoms.list_of_atoms.ListOfAtoms" title="ichor.core.atoms.list_of_atoms.ListOfAtoms"><span class="pre">ListOfAtoms</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="ichor.core.files.html#ichor.core.files.file_data.HasAtoms" title="ichor.core.files.file_data.HasAtoms"><span class="pre">HasAtoms</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#ichor.core.models.Models.get_features_dict" title="Permalink to this definition"></a></dt>
<dd><p>Returns a dictionary containing the atom names as keys and an np.ndarray of features as values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>test_x</strong> – An object that contains features (or coordinates that can be converted into features),
such as <code class="docutils literal notranslate"><span class="pre">Atoms</span></code>, <code class="docutils literal notranslate"><span class="pre">ListOfAtoms</span></code>, <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code>, <code class="docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the atom names as keys and an np.ndarray of features as values</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.Models.ialf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ialf</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#ichor.core.models.Models.ialf" title="Permalink to this definition"></a></dt>
<dd><p>Returns the zero index alf from each model file as a numpy array e.g. [[0, 1, 2], [1, 0, 2], [2, 0, 1]]</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sorting by the first integer in elements of the list will give a
list like this [[0,…], [1,….], [2,….]].
Before that the list could look like [[2,…], [0,….], [1,….]]
(because the models could be unordered) which would mess up the alf for atoms.</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.Models.ialf_dict">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ialf_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ichor.core.models.Models.ialf_dict" title="Permalink to this definition"></a></dt>
<dd><p>Returns the zero index alf from each model file as a dictionary
e.g. {‘O1’: [0, 1, 2], ‘H2’: [1, 0, 2], ‘H3’: [2, 0, 1]}</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.Models.ntrain">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ntrain</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#ichor.core.models.Models.ntrain" title="Permalink to this definition"></a></dt>
<dd><p>Returns the maximum number of training points that were used for a model in this <cite>Models</cite> instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.Models.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ichor.core.models.Models.predict" title="Permalink to this definition"></a></dt>
<dd><p>Returns dictionary of DataFrame({“atom”: {“property”: [values]}})</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.Models.system">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">system</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#ichor.core.models.Models.system" title="Permalink to this definition"></a></dt>
<dd><p>Returns the name of the system for which models were made.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ichor.core.models.Models.types">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">types</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#ichor.core.models.Models.types" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of types (such as q00, q10, iqa, etc.) for which models were made</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ichor.core.models.Models.variance">
<span class="sig-name descname"><span class="pre">variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ichor.core.models.Models.variance" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ichor.core.files.xyz.html" class="btn btn-neutral float-left" title="ichor.core.files.xyz package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ichor.core.models.kernels.html" class="btn btn-neutral float-right" title="ichor.core.models.kernels package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Yulian Manchev.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

</body>
</html>
